import{z as Se,u as Ue,r as v,A as $e,L as Ie,d as r,K as ee,o as d,c as f,B as b,C as oe,e,w as o,x as a,h as Pe,G as I,M as P,i as h,j as C,n as s,v as j,k as O,q as qe}from"./index.577ac416.js";import{l as Te,c as Ge,r as Ee,g as le,u as Re,a as De,d as Je}from"./job.ceddf727.js";const Be={class:"app-container"},Le=s("\u641C\u7D22"),ze=s("\u91CD\u7F6E"),Fe=s("\u65B0\u589E"),Ke=s("\u4FEE\u6539"),Oe=s("\u5220\u9664"),Qe=s("\u5BFC\u51FA"),Ae=s("\u65E5\u5FD7"),Me=s(" \u8C03\u7528\u65B9\u6CD5 "),He=C("div",null,[s(" Bean\u8C03\u7528\u793A\u4F8B\uFF1AryTask.ryParams('ry') "),C("br"),s("Class\u7C7B\u8C03\u7528\u793A\u4F8B\uFF1Acom.ruoyi.quartz.task.RyTask.ryParams('ry') "),C("br"),s("\u53C2\u6570\u8BF4\u660E\uFF1A\u652F\u6301\u5B57\u7B26\u4E32\uFF0C\u5E03\u5C14\u7C7B\u578B\uFF0C\u957F\u6574\u578B\uFF0C\u6D6E\u70B9\u578B\uFF0C\u6574\u578B ")],-1),We=s(" \u751F\u6210\u8868\u8FBE\u5F0F "),Xe=C("i",{class:"el-icon-time el-icon--right"},null,-1),Ye=s("\u7ACB\u5373\u6267\u884C"),Ze=s("\u6267\u884C\u4E00\u6B21"),eo=s("\u653E\u5F03\u6267\u884C"),oo=s("\u5141\u8BB8"),lo=s("\u7981\u6B62"),to={class:"dialog-footer"},ao=s("\u786E \u5B9A"),no=s("\u53D6 \u6D88"),uo={key:0},so={key:1},io={key:0},ro={key:1},po={key:0},co={key:1},_o={key:2},mo={key:3},fo={class:"dialog-footer"},bo=s("\u5173 \u95ED"),vo=Se({name:"Job"}),jo=Object.assign(vo,{setup(go){const te=Ue(),{proxy:_}=qe(),{sys_job_group:U,sys_job_status:Q}=_.useDict("sys_job_group","sys_job_status"),A=v([]),V=v(!1),q=v(!0),T=v(!0),G=v([]),M=v(!0),H=v(!0),E=v(0),R=v(""),$=v(!1),ae=v(!1),ne=v(""),ue=$e({form:{},queryParams:{pageNum:1,pageSize:10,jobName:void 0,jobGroup:void 0,status:void 0},rules:{jobName:[{required:!0,message:"\u4EFB\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],invokeTarget:[{required:!0,message:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],cronExpression:[{required:!0,message:"cron\u6267\u884C\u8868\u8FBE\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:m,form:n,rules:se}=Ie(ue);function k(){q.value=!0,Te(m.value).then(u=>{A.value=u.rows,E.value=u.total,q.value=!1})}function de(u,t){return _.selectDictLabel(U.value,u.jobGroup)}function ie(){V.value=!1,D()}function D(){n.value={jobId:void 0,jobName:void 0,jobGroup:void 0,invokeTarget:void 0,cronExpression:void 0,misfirePolicy:1,concurrent:1,status:"0"},_.resetForm("jobRef")}function J(){m.value.pageNum=1,k()}function re(){_.resetForm("queryRef"),J()}function pe(u){G.value=u.map(t=>t.jobId),M.value=u.length!=1,H.value=!u.length}function ce(u){let t=u.status==="0"?"\u542F\u7528":"\u505C\u7528";_.$modal.confirm('\u786E\u8BA4\u8981"'+t+'""'+u.jobName+'"\u4EFB\u52A1\u5417?').then(function(){return Ge(u.jobId,u.status)}).then(()=>{_.$modal.msgSuccess(t+"\u6210\u529F")}).catch(function(){u.status=u.status==="0"?"1":"0"})}function _e(u){_.$modal.confirm('\u786E\u8BA4\u8981\u7ACB\u5373\u6267\u884C\u4E00\u6B21"'+u.jobName+'"\u4EFB\u52A1\u5417?').then(function(){return Ee(u.jobId,u.jobGroup)}).then(()=>{_.$modal.msgSuccess("\u6267\u884C\u6210\u529F")}).catch(()=>{})}function me(u){le(u.jobId).then(t=>{n.value=t.data,$.value=!0})}function fe(){ne.value=n.value.cronExpression,ae.value=!0}function W(u){const t=u.jobId||0;te.push({path:"/monitor/job-log/index",query:{jobId:t}})}function be(){D(),V.value=!0,R.value="\u6DFB\u52A0\u4EFB\u52A1"}function X(u){D();const t=u.jobId||G.value;le(t).then(x=>{n.value=x.data,V.value=!0,R.value="\u4FEE\u6539\u4EFB\u52A1"})}function ve(){_.$refs.jobRef.validate(u=>{u&&(n.value.jobId!=null?Re(n.value).then(t=>{_.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),V.value=!1,k()}):De(n.value).then(t=>{_.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),V.value=!1,k()}))})}function Y(u){const t=u.jobId||G.value;_.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u5B9A\u65F6\u4EFB\u52A1\u7F16\u53F7\u4E3A"'+t+'"\u7684\u6570\u636E\u9879?').then(function(){return Je(t)}).then(()=>{k(),_.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function ge(){_.download("monitor/job/export",{...m.value},`job_${new Date().getTime()}.xlsx`)}return k(),(u,t)=>{const x=r("el-input"),i=r("el-form-item"),B=r("el-option"),L=r("el-select"),c=r("el-button"),z=r("el-form"),p=r("el-col"),he=r("right-toolbar"),F=r("el-row"),y=r("el-table-column"),ye=r("dict-tag"),je=r("el-switch"),N=r("el-tooltip"),Ve=r("el-table"),ke=r("pagination"),we=r("question-filled"),Ce=r("el-icon"),S=r("el-radio-button"),K=r("el-radio-group"),xe=r("el-radio"),Z=r("el-dialog"),g=ee("hasPermi"),Ne=ee("loading");return d(),f("div",Be,[b(e(z,{model:a(m),ref:"queryRef",inline:!0,"label-width":"68px"},{default:o(()=>[e(i,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"jobName"},{default:o(()=>[e(x,{modelValue:a(m).jobName,"onUpdate:modelValue":t[0]||(t[0]=l=>a(m).jobName=l),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",clearable:"",onKeyup:Pe(J,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(i,{label:"\u4EFB\u52A1\u7EC4\u540D",prop:"jobGroup"},{default:o(()=>[e(L,{modelValue:a(m).jobGroup,"onUpdate:modelValue":t[1]||(t[1]=l=>a(m).jobGroup=l),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u7EC4\u540D",clearable:""},{default:o(()=>[(d(!0),f(I,null,P(a(U),l=>(d(),h(B,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u4EFB\u52A1\u72B6\u6001",prop:"status"},{default:o(()=>[e(L,{modelValue:a(m).status,"onUpdate:modelValue":t[2]||(t[2]=l=>a(m).status=l),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u72B6\u6001",clearable:""},{default:o(()=>[(d(!0),f(I,null,P(a(Q),l=>(d(),h(B,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,null,{default:o(()=>[e(c,{type:"primary",icon:"Search",onClick:J},{default:o(()=>[Le]),_:1}),e(c,{icon:"Refresh",onClick:re},{default:o(()=>[ze]),_:1})]),_:1})]),_:1},8,["model"]),[[oe,T.value]]),e(F,{gutter:10,class:"mb8"},{default:o(()=>[e(p,{span:1.5},{default:o(()=>[b((d(),h(c,{type:"primary",plain:"",icon:"Plus",onClick:be},{default:o(()=>[Fe]),_:1})),[[g,["monitor:job:add"]]])]),_:1},8,["span"]),e(p,{span:1.5},{default:o(()=>[b((d(),h(c,{type:"success",plain:"",icon:"Edit",disabled:M.value,onClick:X},{default:o(()=>[Ke]),_:1},8,["disabled"])),[[g,["monitor:job:edit"]]])]),_:1},8,["span"]),e(p,{span:1.5},{default:o(()=>[b((d(),h(c,{type:"danger",plain:"",icon:"Delete",disabled:H.value,onClick:Y},{default:o(()=>[Oe]),_:1},8,["disabled"])),[[g,["monitor:job:remove"]]])]),_:1},8,["span"]),e(p,{span:1.5},{default:o(()=>[b((d(),h(c,{type:"warning",plain:"",icon:"Download",onClick:ge},{default:o(()=>[Qe]),_:1})),[[g,["monitor:job:export"]]])]),_:1},8,["span"]),e(p,{span:1.5},{default:o(()=>[b((d(),h(c,{type:"info",plain:"",icon:"Operation",onClick:W},{default:o(()=>[Ae]),_:1})),[[g,["monitor:job:query"]]])]),_:1},8,["span"]),e(he,{showSearch:T.value,"onUpdate:showSearch":t[3]||(t[3]=l=>T.value=l),onQueryTable:k},null,8,["showSearch"])]),_:1}),b((d(),h(Ve,{data:A.value,onSelectionChange:pe},{default:o(()=>[e(y,{type:"selection",width:"55",align:"center"}),e(y,{label:"\u4EFB\u52A1\u7F16\u53F7",width:"100",align:"center",prop:"jobId"}),e(y,{label:"\u4EFB\u52A1\u540D\u79F0",align:"center",prop:"jobName","show-overflow-tooltip":!0}),e(y,{label:"\u4EFB\u52A1\u7EC4\u540D",align:"center",prop:"jobGroup"},{default:o(l=>[e(ye,{options:a(U),value:l.row.jobGroup},null,8,["options","value"])]),_:1}),e(y,{label:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32",align:"center",prop:"invokeTarget","show-overflow-tooltip":!0}),e(y,{label:"cron\u6267\u884C\u8868\u8FBE\u5F0F",align:"center",prop:"cronExpression","show-overflow-tooltip":!0}),e(y,{label:"\u72B6\u6001",align:"center"},{default:o(l=>[e(je,{modelValue:l.row.status,"onUpdate:modelValue":w=>l.row.status=w,"active-value":"0","inactive-value":"1",onChange:w=>ce(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(y,{label:"\u64CD\u4F5C",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:o(l=>[e(N,{content:"\u4FEE\u6539",placement:"top"},{default:o(()=>[b(e(c,{type:"text",icon:"Edit",onClick:w=>X(l.row)},null,8,["onClick"]),[[g,["monitor:job:edit"]]])]),_:2},1024),e(N,{content:"\u5220\u9664",placement:"top"},{default:o(()=>[b(e(c,{type:"text",icon:"Delete",onClick:w=>Y(l.row)},null,8,["onClick"]),[[g,["monitor:job:remove"]]])]),_:2},1024),e(N,{content:"\u6267\u884C\u4E00\u6B21",placement:"top"},{default:o(()=>[b(e(c,{type:"text",icon:"CaretRight",onClick:w=>_e(l.row)},null,8,["onClick"]),[[g,["monitor:job:changeStatus"]]])]),_:2},1024),e(N,{content:"\u4EFB\u52A1\u8BE6\u7EC6",placement:"top"},{default:o(()=>[b(e(c,{type:"text",icon:"View",onClick:w=>me(l.row)},null,8,["onClick"]),[[g,["monitor:job:query"]]])]),_:2},1024),e(N,{content:"\u8C03\u5EA6\u65E5\u5FD7",placement:"top"},{default:o(()=>[b(e(c,{type:"text",icon:"Operation",onClick:w=>W(l.row)},null,8,["onClick"]),[[g,["monitor:job:query"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Ne,q.value]]),b(e(ke,{total:E.value,page:a(m).pageNum,"onUpdate:page":t[4]||(t[4]=l=>a(m).pageNum=l),limit:a(m).pageSize,"onUpdate:limit":t[5]||(t[5]=l=>a(m).pageSize=l),onPagination:k},null,8,["total","page","limit"]),[[oe,E.value>0]]),e(Z,{title:R.value,modelValue:V.value,"onUpdate:modelValue":t[13]||(t[13]=l=>V.value=l),width:"800px","append-to-body":""},{footer:o(()=>[C("div",to,[e(c,{type:"primary",onClick:ve},{default:o(()=>[ao]),_:1}),e(c,{onClick:ie},{default:o(()=>[no]),_:1})])]),default:o(()=>[e(z,{ref:"jobRef",model:a(n),rules:a(se),"label-width":"120px"},{default:o(()=>[e(F,null,{default:o(()=>[e(p,{span:12},{default:o(()=>[e(i,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"jobName"},{default:o(()=>[e(x,{modelValue:a(n).jobName,"onUpdate:modelValue":t[6]||(t[6]=l=>a(n).jobName=l),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u4EFB\u52A1\u5206\u7EC4",prop:"jobGroup"},{default:o(()=>[e(L,{modelValue:a(n).jobGroup,"onUpdate:modelValue":t[7]||(t[7]=l=>a(n).jobGroup=l),placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(d(!0),f(I,null,P(a(U),l=>(d(),h(B,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:24},{default:o(()=>[e(i,{prop:"invokeTarget"},{label:o(()=>[C("span",null,[Me,e(N,{placement:"top"},{content:o(()=>[He]),default:o(()=>[e(Ce,null,{default:o(()=>[e(we)]),_:1})]),_:1})])]),default:o(()=>[e(x,{modelValue:a(n).invokeTarget,"onUpdate:modelValue":t[8]||(t[8]=l=>a(n).invokeTarget=l),placeholder:"\u8BF7\u8F93\u5165\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:24},{default:o(()=>[e(i,{label:"cron\u8868\u8FBE\u5F0F",prop:"cronExpression"},{default:o(()=>[e(x,{modelValue:a(n).cronExpression,"onUpdate:modelValue":t[9]||(t[9]=l=>a(n).cronExpression=l),placeholder:"\u8BF7\u8F93\u5165cron\u6267\u884C\u8868\u8FBE\u5F0F"},{append:o(()=>[e(c,{type:"primary",onClick:fe},{default:o(()=>[We,Xe]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:24},{default:o(()=>[e(i,{label:"\u6267\u884C\u7B56\u7565",prop:"misfirePolicy"},{default:o(()=>[e(K,{modelValue:a(n).misfirePolicy,"onUpdate:modelValue":t[10]||(t[10]=l=>a(n).misfirePolicy=l)},{default:o(()=>[e(S,{label:"1"},{default:o(()=>[Ye]),_:1}),e(S,{label:"2"},{default:o(()=>[Ze]),_:1}),e(S,{label:"3"},{default:o(()=>[eo]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u662F\u5426\u5E76\u53D1",prop:"concurrent"},{default:o(()=>[e(K,{modelValue:a(n).concurrent,"onUpdate:modelValue":t[11]||(t[11]=l=>a(n).concurrent=l)},{default:o(()=>[e(S,{label:"0"},{default:o(()=>[oo]),_:1}),e(S,{label:"1"},{default:o(()=>[lo]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u72B6\u6001"},{default:o(()=>[e(K,{modelValue:a(n).status,"onUpdate:modelValue":t[12]||(t[12]=l=>a(n).status=l)},{default:o(()=>[(d(!0),f(I,null,P(a(Q),l=>(d(),h(xe,{key:l.value,label:l.value},{default:o(()=>[s(j(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(Z,{title:"\u4EFB\u52A1\u8BE6\u7EC6",modelValue:$.value,"onUpdate:modelValue":t[15]||(t[15]=l=>$.value=l),width:"700px","append-to-body":""},{footer:o(()=>[C("div",fo,[e(c,{onClick:t[14]||(t[14]=l=>$.value=!1)},{default:o(()=>[bo]),_:1})])]),default:o(()=>[e(z,{model:a(n),"label-width":"120px"},{default:o(()=>[e(F,null,{default:o(()=>[e(p,{span:12},{default:o(()=>[e(i,{label:"\u4EFB\u52A1\u7F16\u53F7\uFF1A"},{default:o(()=>[s(j(a(n).jobId),1)]),_:1}),e(i,{label:"\u4EFB\u52A1\u540D\u79F0\uFF1A"},{default:o(()=>[s(j(a(n).jobName),1)]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u4EFB\u52A1\u5206\u7EC4\uFF1A"},{default:o(()=>[s(j(de(a(n))),1)]),_:1}),e(i,{label:"\u521B\u5EFA\u65F6\u95F4\uFF1A"},{default:o(()=>[s(j(a(n).createTime),1)]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"cron\u8868\u8FBE\u5F0F\uFF1A"},{default:o(()=>[s(j(a(n).cronExpression),1)]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u4E0B\u6B21\u6267\u884C\u65F6\u95F4\uFF1A"},{default:o(()=>[s(j(u.parseTime(a(n).nextValidTime)),1)]),_:1})]),_:1}),e(p,{span:24},{default:o(()=>[e(i,{label:"\u8C03\u7528\u76EE\u6807\u65B9\u6CD5\uFF1A"},{default:o(()=>[s(j(a(n).invokeTarget),1)]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u4EFB\u52A1\u72B6\u6001\uFF1A"},{default:o(()=>[a(n).status==0?(d(),f("div",uo,"\u6B63\u5E38")):a(n).status==1?(d(),f("div",so,"\u5931\u8D25")):O("",!0)]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u662F\u5426\u5E76\u53D1\uFF1A"},{default:o(()=>[a(n).concurrent==0?(d(),f("div",io,"\u5141\u8BB8")):a(n).concurrent==1?(d(),f("div",ro,"\u7981\u6B62")):O("",!0)]),_:1})]),_:1}),e(p,{span:12},{default:o(()=>[e(i,{label:"\u6267\u884C\u7B56\u7565\uFF1A"},{default:o(()=>[a(n).misfirePolicy==0?(d(),f("div",po,"\u9ED8\u8BA4\u7B56\u7565")):a(n).misfirePolicy==1?(d(),f("div",co,"\u7ACB\u5373\u6267\u884C")):a(n).misfirePolicy==2?(d(),f("div",_o,"\u6267\u884C\u4E00\u6B21")):a(n).misfirePolicy==3?(d(),f("div",mo,"\u653E\u5F03\u6267\u884C")):O("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{jo as default};
